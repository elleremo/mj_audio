/*
 By Osvaldas Valutis, www.osvaldas.info
 Available for use under the MIT License
 */
!function(e,t,a,i){var n="ontouchstart"in t,d=n?"touchstart":"mousedown",o=n?"touchmove":"mousemove",l=n?"touchcancel":"mouseup",u=function(e){var t=e/3600,a=Math.floor(t),i=e%3600/60,n=Math.floor(i),d=Math.ceil(e%3600%60);return d>59&&(d=0,n=Math.ceil(i)),n>59&&(n=0,a=Math.ceil(t)),(0==a?"":a>0&&a.toString().length<2?"0"+a+":":a+":")+(n.toString().length<2?"0"+n:n)+":"+(d.toString().length<2?"0"+d:d)},s=function(e){var t=a.createElement("audio");return!(!t.canPlayType||!t.canPlayType("audio/"+e.split(".").pop().toLowerCase()+";").replace(/no/,""))};e.fn.audioPlayer=function(t){var t=e.extend({classPrefix:"audioplayer",strPlay:"Play",strPause:"Pause",strVolume:"Volume"},t),a={},i={playPause:"playpause",playing:"playing",stopped:"stopped",time:"time",timeCurrent:"time-current",timeDuration:"time-duration",bar:"bar",barLoaded:"bar-loaded",barLoadedInside:"bar-loaded-inside",barPlayedInside:"bar-played-inside",barLoadedIcon:"bar-loaded-icon",barPlayed:"bar-played",volume:"volume",volumeButton:"volume-button",volumeAdjust:"volume-adjust",noVolume:"novolume",muted:"muted",mini:"mini"};for(var r in i)a[r]=t.classPrefix+"-"+i[r];return this.each(function(){if("audio"!=e(this).prop("tagName").toLowerCase())return!1;var i=e(this),r=i.attr("src"),v=i.get(0).getAttribute("autoplay"),v=""===v||"autoplay"===v,m=i.get(0).getAttribute("loop"),m=""===m||"loop"===m,c=!1;"undefined"==typeof r?i.find("source").each(function(){if(r=e(this).attr("src"),"undefined"!=typeof r&&s(r))return c=!0,!1}):s(r)&&(c=!0);var h=e('<div class="'+t.classPrefix+'">'+(c?e("<div>").append(i.eq(0).clone()).html():'<embed src="'+r+'" width="0" height="0" volume="100" autostart="'+v.toString()+'" loop="'+m.toString()+'" />')+'<div class="'+a.playPause+'" title="'+t.strPlay+'"><a href="#">'+t.strPlay+"</a></div></div>"),f=c?h.find("audio"):h.find("embed"),f=f.get(0);if(c){h.find("audio").css({width:0,height:0,visibility:"hidden"}),h.append('<div class="'+a.time+" "+a.timeCurrent+'"></div><div class="'+a.bar+'"><div class="'+a.barLoaded+'"><div class="'+a.barLoadedInside+'"></div></div><div class="'+a.barPlayed+'"> <div class="'+a.barPlayedInside+'"> <div class="'+a.barLoadedIcon+'"></div> </div> </div></div><div class="'+a.time+" "+a.timeDuration+'"></div><div class="'+a.volume+'"><div class="'+a.volumeButton+'" title="'+t.strVolume+'"><a href="#">'+t.strVolume+'</a></div><div class="'+a.volumeAdjust+'"><div><div></div></div></div></div>');var p=h.find("."+a.bar),y=h.find("."+a.barPlayed),b=h.find("."+a.barLoaded),g=h.find("."+a.timeCurrent),P=h.find("."+a.timeDuration),C=h.find("."+a.volumeButton),L=h.find("."+a.volumeAdjust+" > div"),E=0,w=function(e){theRealEvent=n?e.originalEvent.touches[0]:e,f.currentTime=Math.round(f.duration*(theRealEvent.pageX-p.offset().left)/p.width())},M=function(e){theRealEvent=n?e.originalEvent.touches[0]:e,f.volume=Math.abs((theRealEvent.pageY-(L.offset().top+L.height()))/L.height())},I=function(){var e=setInterval(function(){return f.buffered.length<1||(b.width(f.buffered.end(0)/f.duration*100+"%"),void(Math.floor(f.buffered.end(0))>=Math.floor(f.duration)&&clearInterval(e)))},100)},S=f.volume,V=f.volume=.111;Math.round(1e3*f.volume)/1e3==V?f.volume=S:h.addClass(a.noVolume),P.html("&hellip;"),g.html(u(0)),f.addEventListener("loadeddata",function(){I(),P.html(e.isNumeric(f.duration)?u(f.duration):"&hellip;"),L.find("div").height(100*f.volume+"%"),E=f.volume}),f.addEventListener("timeupdate",function(){g.html(u(f.currentTime)),y.width(f.currentTime/f.duration*100+"%")}),f.addEventListener("volumechange",function(){L.find("div").height(100*f.volume+"%"),f.volume>0&&h.hasClass(a.muted)&&h.removeClass(a.muted),f.volume<=0&&!h.hasClass(a.muted)&&h.addClass(a.muted)}),f.addEventListener("ended",function(){h.removeClass(a.playing).addClass(a.stopped)}),p.on(d,function(e){w(e),p.on(o,function(e){w(e)})}).on(l,function(){p.unbind(o)}),C.on("click",function(){return h.hasClass(a.muted)?(h.removeClass(a.muted),f.volume=E):(h.addClass(a.muted),E=f.volume,f.volume=0),!1}),L.on(d,function(e){M(e),L.on(o,function(e){M(e)})}).on(l,function(){L.unbind(o)})}else h.addClass(a.mini);h.addClass(v?a.playing:a.stopped),h.find("."+a.playPause).on("click",function(){return h.hasClass(a.playing)?(e(this).attr("title",t.strPlay).find("a").html(t.strPlay),h.removeClass(a.playing).addClass(a.stopped),c?f.pause():f.Stop()):(e(this).attr("title",t.strPause).find("a").html(t.strPause),h.addClass(a.playing).removeClass(a.stopped),c?f.play():f.Play()),!1}),i.replaceWith(h)}),this}}(jQuery,window,document);